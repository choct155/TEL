install.packages("ISLR")
library(MASS)
library(ISLR)
names(Boston)
?Boston
library(ggplot2)
ggplot(Boston,aes(medv,lstat)) + geom_point()
ggplot(Boston,aes(lstat,medv)) + geom_point()
fit1>-lm(medv~lstat,Boston)
fit1->lm(medv~lstat,Boston)
fit1<-lm(medv~lstat,Boston)
summary(fit1)
abline(fit1,col='red')
ggplot(Boston,aes(lstat,medv)) + geom_point() + geom_abline()
#Regress medv on lstat
?fit1
?lm
fit1<-lm(medv~lstat,Boston)
fit1[coefficients]
fit1$coefficients
fit1$coefficients[1]
fit1$coefficients[2]
fit1$coefficients[lstat]
fit1$coefficients$lstat
ggplot(Boston,aes(lstat,medv)) + geom_point() + geom_abline(intercept=fit$coef)
fit1$coef
ggplot(Boston,aes(lstat,medv)) + geom_point() + geom_abline(intercept=fit1$coef[1])
ggplot(Boston,aes(lstat,medv)) + geom_point() + geom_abline(intercept=fit1$coef[1],slope=fit1$coef[2])
ggplot(Boston,aes(lstat,medv)) + geom_point() + geom_abline(intercept=fit1$coef[1],slope=fit1$coef[2],colour="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm')
predict(fit1,data.frame(lstat=c(5,10,15)),interval='confidence')
fit2<-lm(medv~lstat+age,Boston)
summary(fit2)
fit3<-lm(medv~.,Boston)
summary(fit3)
plot(fit3)
par(mfrow=c(2,2))
plot(fit3)
fit4<-update(fit3,~. -age -indus)
summary(fit4)
fit5<-lm(medv~lstat*age,Boston)
summary(fit5)
fit6<-lm(medv~lstat+I(lstat^2),Boston); summary(fit6)
?stat_smooth
par(mfrow=c(1,1))
plot(medv~lstat)
plot(Boston$medv~Boston$lstat)
points(Boston$lstat,fitted(fit6),col="red",pch=20)
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',formula=medv~poly(lstat,3),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',formula=Boston$medv~poly(Boston$lstat,3),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',
formula=Boston$medv~poly(Boston$lstat,3,raw=TRUE),color="red")
formula=Boston$medv~poly(Boston$lstat,2,raw=TRUE),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',
formula=Boston$medv~poly(Boston$lstat,2,raw=TRUE),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',se=TRUE,fill=NA,
formula=Boston$medv~poly(Boston$lstat,2,raw=TRUE),color="red")
traceback()
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',se=TRUE,fill=NA,
formula=Boston$medv~poly(Boston$lstat,2,raw=TRUE),color="red")
traceback()
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',se=FALSE,fill=NA,
formula=Boston$medv~poly(Boston$lstat,2,raw=TRUE),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',se=FALSE,fill=NA,
formula=y~poly(x,2,raw=TRUE),color="red")
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',se=TRUE,fill=NA,
formula=y~poly(x,2,raw=TRUE),color="red")
?stat_smooth
formula=y~poly(x,2))
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',
formula=y~poly(x,2))
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',formula=y~poly(x,2)) +
stat_smooth(method='lm',formula=y~poly(x,4))
ggplot(Boston,aes(lstat,medv)) + geom_point() + stat_smooth(method='lm',formula=y~poly(x,2)) +
stat_smooth(method='lm',formula=y~poly(x,4),color="red")
fix(Carseats)
cfit1<-lm(Sales~.+Income:Advertising+Age:Price,Carseats); summary(cfit1)
contrasts(Carseats$ShelveLoc)
?lm
?islr
?ISLR
